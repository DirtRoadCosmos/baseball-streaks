<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Baseball Streaks</title>
    <style>
        .team-card {
            border: 1px solid;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="text-center my-4">Baseball Streaks</h1>
        <div id="teams-container"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/relativeTime.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/utc.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/calendar.js"></script>
<script>
        dayjs.extend(window.dayjs_plugin_relativeTime);
        dayjs.extend(window.dayjs_plugin_utc);
        dayjs.extend(window.dayjs_plugin_calendar);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        async function fetchTeams() {
            const response = await fetch('/api/v1/teams');
            const teams = await response.json();
            const container = document.getElementById('teams-container');
            teams.forEach(team => {
                console.log(team);
                if (team.winStreak < 1) {
                    return
                }
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                teamCard.style.borderColor = `#${team.secondaryColor}`;
                teamCard.style.color =  `#${team.secondaryColor}`;
                teamCard.style.backgroundColor = `#${team.primaryColor}`;

                const teamName = document.createElement('h3');
                teamName.textContent = `${team.name} - Win Streak: ${team.winStreak}`;
                teamCard.appendChild(teamName);

                if (team.currentOrNextGame) {
                    const gameInfo = document.createElement('p');
                    gameInfo.textContent =
                        `${team.currentOrNextGame.awayTeam} @ ${team.currentOrNextGame.homeTeam}`;
                    teamCard.appendChild(gameInfo);

                    if (team.currentOrNextGame.status === 'In Progress') {
                        const scoreInfo = document.createElement('p');
                        scoreInfo.textContent = `In Progress: ${
                            team.currentOrNextGame.score.away
                        } - ${
                            team.currentOrNextGame.score.home
                        }`;
                        teamCard.appendChild(scoreInfo);
                    } else {
                        const gameInfo = document.createElement('p');
                        gameInfo.textContent = dayjs(team.currentOrNextGame.firstPitch).calendar();
                        teamCard.appendChild(gameInfo);
                    }
                } else {
                    const noGameInfo = document.createElement('p');
                    noGameInfo.textContent = 'No upcoming game found';
                    teamCard.appendChild(noGameInfo);
                }
                container.appendChild(teamCard);
            });
        }

        fetchTeams();
    </script>
</body>

</html>